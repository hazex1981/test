
<div data-role="header" data-position="fixed" data-theme="b"
style="
	width:800px;
    margin-left : auto ; margin-right : auto;"

>
  <div data-role="navbar">
    <ul>
      <li><%= link_to "検索",categories_path %></li>
      <li><%= link_to "メッセージ",messages_path %></li>
      <li><%= link_to "プロフィール",profile_user_path(@current_user.id) %></li>
    </ul>
  </div>
</div>


<div data-role="content"
style="background:none repeat-x scroll 0 0 #e6e6fa;
	width:770px;
	height:800px;
	margin-left : auto ; margin-right : auto;"
>


  <!--　メッセージ簡易表示する。 -->
  <ul data-role="listview" data-theme="c">

    <% @messages.each do |message| %>
      
      <li style="background: #e6e6fa;">
        <!-- ログインユーザーが、ユーザーとしてセッションを組んだ場合。 --> 
        <% if @current_user.id == message.session.user_id %>
        
          <a href="/messages/<%= message.session.expert_id %>/feed?role=user">    
            <% if message.post_id == @current_user.id %>
              自分からエキスパート(<%= User.find(message.session.expert_id).name %>)さんへ質問。
               <%= image_tag(User.find(message.session.expert_id).image,:size=>'60x60',:class=>'user_image') %>            
            <% else %>
              エキスパート(<%= User.find(message.session.expert_id).name %>)さんから回答。
              <%= image_tag(User.find(message.session.expert_id).image,:size=>'60x60',:class=>'user_image') %>    
            <% end %>

            <!--　チャット中、終了、パスかどうかを表示する。-->
            <div class="session_status">

            <% if message.session.status == 0 || message.session.status == 1 %>
              <span class="chat">チャット中</span>
            <% elsif message.session.status == 2 %>
               <span class="pass">パス</span>
            <% elsif message.session.status == 3 %>
              <span class="pass">終了</span>
            <% end %> 
            
            </div>
            
            <br />
              メッセージ: <%= message.content %> 
          </a>

        <% else %>
        <!-- ログインユーザーがエキスパートとして、セッションを組んだ場合。 -->
          <a href="/messages/<%= message.session.user_id %>/feed?role=expert"> 
            <% if message.post_id == @current_user.id %>
              自分から質問者(<%= User.find(message.session.user_id).name %>)さんへ回答。 
              <%= image_tag(User.find(message.session.user_id).image,:size=>'60x60',:class=>'user_image') %>    
            <% else %>
              質問者(<%= User.find(message.session.user_id).name %>)
              <%= image_tag(User.find(message.session.user_id).image,:size=>'60x60',:class=>'user_image') %>  
            <% end %>
            
               
            <div class="session_status">

            <!--　チャット中、終了、パスかどうかを表示する。-->
                <% if message.session.status == 0 || message.session.status == 1 %>
              <span class="chat">チャット中</span>
            <% elsif message.session.status == 2 %>
               <span class="pass">パス</span>
            <% elsif message.session.status == 3 %>
              <span class="pass">終了</span>
            <% end %> 
            
            </div>
            
            <br />
              メッセージ: <%= message.content %> 
          </a>
        <% end %>

      </li>
    <% end %>

  </ul>





</div>









